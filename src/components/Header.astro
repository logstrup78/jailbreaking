---
import Layout from "../layouts/Layout.astro"
const {pathname} = Astro.url;
const { current } = Astro.props; 

---
<Layout>
<header>
    <nav>
        <ul id="menu">
        
        </ul>
    </nav>
</header>
</Layout>

<style>
    :global(header){
        width: 100%;
        height: 80px;
        background-color: #D9DDFE;
        display: flex;
        justify-content: center;
        align-items: center;


    }
    :global(nav ul){
        display: flex;
        gap: 30px;
        margin: 0;
  padding: 0;
  list-style: none;
    }
    
:global(a){
    text-decoration: none;
    text-transform: uppercase;
}

    :global(nav a.active){
        border-bottom: 1px solid #333;
    }
</style>

<script>

    
  const allPages = [
  { path: "/", label: "Start" },
  { path: "/id", label: "ID" },
  { path: "/questions", label: "Spørgeskema" },
  { path: "/jailbreak", label: "Jailbreak" },
  { path: "/grupperefleksion", label: "Grupperefleksion" },
  { path: "/refleksion", label: "Refleksion" },
  { path: "/afslut", label: "Afslutning" },
];

const menu = document.getElementById("menu") as HTMLUListElement | null;

const currentPage = window.location.pathname;

// Nulstil visited hvis vi er på forsiden
if (currentPage === "/") {
  localStorage.setItem("visitedPages", JSON.stringify(["/"]));
}

const visited: string[] = JSON.parse(localStorage.getItem("visitedPages") || "[]");

if (!visited.includes(currentPage)) {
  visited.push(currentPage);
  localStorage.setItem("visitedPages", JSON.stringify(visited));
}

if (menu) {
  allPages.forEach(({ path, label }) => {
    if (visited.includes(path)) {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = path;
      a.textContent = label;
      if (path === currentPage) a.classList.add("active");
      li.appendChild(a);
      menu.appendChild(li);
    }
  });
}
</script>